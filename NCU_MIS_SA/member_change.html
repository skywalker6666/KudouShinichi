<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MemberCenter</title>
	<style>
	</style>
 	<link rel="stylesheet" href="statics/css/register&login.css">
 	<link rel="stylesheet" href="statics/css/navbar.css">
 	<link rel="stylesheet" href="statics/css/themebox.css">
 	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
 	
 	
</head>
<body bgcolor="#BCE2FF">
	<ul class="navbar">
		<li class="navbar"><a href="index.html"><img src="statics/img/navbar/icon.png" style="float: left" height="100px" width="100px" ></img></a></li>
		<li class="navbar"><a class="navbarItem" href="index.html">Home</a></li>
		<li class="navbar"><a class="navbarItem" href="productIndex.html">商品總覽</a></li>
		<li class="navbar"><a class="navbarItem" href="order_tracking.html">訂單追蹤</a></li>
		<li class="navbar"><a class="navbarItem" href="shoppingcart.html">購物車</a></li>
		<li class="navbar"><a id="myMarket" class="navbarItem" href="my_market.html">我的賣場</a></li>
		<li id="signup_in" style="float: right"><a class="navbarItemSide" href="login_selected.html">會員註冊/登入</a></li>
		
		<div id="member_center1" class="mediumbox" style="float: right">
			<li style="float: left"><a class="navbarFloating"
				href="member_change.html">會員中心</a></li>
			<li style="float: left"><a id="remove" class="navbarFloating"
				href="index.html">&nbsp;登出 </a></li>
			<li style="float: left">
	
		</div>
		<div id="member_center2" class="smallbox" style="float: right"> 
			<li><img src="statics/img/navbar/shoppingcart.png"
				style="float: left" height="20px" width="20px"></img></li>
			<li><a class="navbarFloating" href="shoppingcart.html">購物車</a></li>
		</div>
		<div id="member_center3" class="smallbox" style="float: right">
			<li><img src="statics/img/navbar/user.png" style="float: left"
				height="20px" width="20px"></img></li>
			<li id="user_name"class="navbarFloating">user</li>
		</div>
	</ul>
	<div class="box" >
			<label class="box_text" >會員中心</label>
		<div class="box2" >		
			<form class="form" id="form" accept-charset="utf-8">				
				<div>
					<input class="button" type="button" style="margin-top:60px" value="更改密碼" onclick="display_password()">
					<input class="button" type="button" style="margin-top:60px" value="更改電子郵件" onclick="display_email()">
					<input class="button" type="button" style="margin-top:60px" value="更改生日" onclick="display_birth()">
					<p id="display"></p>
				</div>
			</form>
		</div>
		
	</div>
	
	<script type="text/javascript">
 /* 	
 	function checkpwd(){
 		var newpwd = $('#newpwd').val();
 		var chkpwd = $('#chkpwd').val();
 		
 		if(newpwd==chkpwd){
 			if(newpwd.length>7 && chkpwd.length>7 ){
 				alert('修改成功');
 				$('#pwdform').submit();
 			}
 			else{
 				alert('密碼長度至少為8碼');
 			}
 		}
 		else{
 			alert('兩者密碼輸入不一樣');
 		}
 		
 		
 			}

 	function checkbirth(){
 		var birth = $('#datepicker').val();
 		if(birth < 1940-01-01 || birth > 2008-12-31){
 			alert('請選填有效值')
 			}
 		
 		else{
 			alert('修改成功');
 			$('#birthform').submit();
 		}
 	}
 	
 	function display_password(){
 		$('#display').html("");
 		$('<form id=pwdform onclick="return false">'+
 				'<div>'+
					'<label>會員原密碼：</label>'+
					'<input class="field" name="password" type="password" id="originpwd" required="required" >'+
				'</div>'+
				'<div>'+
					'<label>會員新密碼：</label>'+
					'<input class="field" name="password" type="password" id="newpwd" required="required" >'+
				'</div>'+
				'<div>'+
					'<label>確認新密碼：</label>'+
					'<input class="field" name="password" type="password" id="chkpwd" required="required" >'+
				'</div>'+
					'<input class="button" id="save" type="submit" value="儲存" onclick="checkpwd()">'+
					'<input class="button" type="submit" value="取消" onclick="empty()" >'+
			'</form>').appendTo('#display')
			
 				}
 	
 	function display_email(){
 		$('#display').html("");
 		$('<input placeholder="會員電子郵件" class="field" name="email" type="email" id="member_email" required="required">'+
 		  '<input class="button" type="submit" value="儲存" >'+
 		  '<input class="button" type="submit" value="取消" onclick="empty()">').appendTo('#display')
 		 		}
 	
 	function display_birth(){
 		$('#display').html("");
 		 
 		$('<label>西元生日：</label>'+
 		  '<input type="date" id="datepicker" min="1940-01-01" max="2008-12-31"  required="required">'+
 		  '<span class="validity"></span>'+
 		  '<form id=birthform onclick="return false">'+
 	 	 	'<div>'+
 	 	 		'<input class="button" type="submit" value="儲存" onclick="checkbirth()">'+
 		  		'<input class="button" type="submit" value="取消" onclick="empty()">'+
 		  	'</div>'+
 		  	'</form>').appendTo('#display')	
 	} 
 	function empty(){
 		$('#display').html("");
 	} */
 	
 	 /*------------登入登出實作member cookie-----------*/
    
    var [client_id, client_name]  = getMemberDataFromClient();
 	
 	//判斷是否是賣家我的賣場
	 var [client_isSeller]  = getisSellerFromClient();
   $("#myMarket").hide();
	if(parseInt(client_isSeller.toString())==1){
		$("#myMarket").show();
	}
	
	function getisSellerFromClient() {
    	let isSeller = JSON.parse(localStorage.getItem("client_isSeller"));
    	
    	isSeller = !isSeller ? new Array() : isSeller;
    	
    	return [isSeller];
    }

   function getMemberDataFromClient() {
   	let id = JSON.parse(localStorage.getItem("client_id"));
   	let name = JSON.parse(localStorage.getItem("client_name"));
   	id = !id ? new Array() : id;
   	name = !name ? new Array() : name;
   	return [id, name];
   }
	
    function updateMemberDataToClent() {
    	localStorage.setItem("client_id", JSON.stringify(client_id));
    	localStorage.setItem("client_name", JSON.stringify(client_name));
        localStorage.setItem("client_cart_obj", JSON.stringify(client_cart_obj));
        localStorage.setItem("client_cart_amount", JSON.stringify(client_cart_amount));
    }
   
   function loguot() {
     client_id = [];
     client_name = [];
     client_cart_obj = [];
     client_cart_amount = [];
     updateMemberDataToClent();
     $("#member_center1").hide();
     $("#member_center2").hide();
     $("#member_center3").hide();
     $("#signup_in").show();
     $("#user_name").empty();
   }
   
   $("#remove").click(function () {
    	console.log("[@Action]登出");
    	loguot();
    });
   
   $(document).ready(function(){
   	 if(client_id.length == 0){ //登出
   		 $("#member_center1").hide();
   	     $("#member_center2").hide();
   	     $("#member_center3").hide();  
   	 }else{//登入
   		 $("#user_name").html(client_name);
      	 	 $("#member_center1").show();
      	 	 $("#member_center2").show();
      	     $("#member_center3").show();
      		 $("#signup_in").hide();
   	 }
   });
  
   /*----------------------------------------*/
 	</script>
</body>
</html>